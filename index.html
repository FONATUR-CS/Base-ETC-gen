<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Turismo Comunitario ‚Äì M√©xico</title>

  <!-- (Opcional) Leaflet CSS: lo puedes dejar por compatibilidad con otras p√°ginas -->
  <link rel="stylesheet" href="js/leaflet.css" />

  <!-- Google Fonts: Noto Sans -->
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Mapbox GL -->
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet"/>

  <!-- Proyecto CSS -->
  <link rel="stylesheet" href="css/styles.css" />

  <!-- Tema oscuro para la portada -->
  <style>
    body.home { background:#000; color:#fff; font-family:'Noto Sans', system-ui, Arial, sans-serif; }
    /* Story en oscuro, manteniendo el verde como acento */
    body.home #story { background:#000; }
    body.home #story h2 { color:#2E8B57; }
    body.home #story a { color:#2E8B57; }
    /* Asegura contraste de listas y textos */
    body.home #story p, body.home #story li { color:#fff; }
    /* El mapa ocupa la mitad derecha como siempre (usa tu CSS base) */
  </style>
</head>
<body class="home">

  <!-- Navegaci√≥n fija -->
  <nav id="main-nav">
    <button id="nav-toggle" aria-label="Abrir men√∫">‚ò∞</button>
    <ul id="nav-menu">
      <li><a href="index.html" class="active">Inicio</a></li>
      <li><a href="estados/baja_california_sur.html">Baja California Sur</a></li>
      <li><a href="estados/hidalgo.html">Hidalgo</a></li>
      <li><a href="estados/michoacan.html">Michoac√°n</a></li>
      <li><a href="estados/morelos.html">Morelos</a></li>
      <li><a href="estados/nayarit.html">Nayarit</a></li>
      <li><a href="estados/oaxaca.html">Oaxaca</a></li>
      <li><a href="estados/puebla.html">Puebla</a></li>
      <li><a href="estados/tlaxcala.html">Tlaxcala</a></li>
      <li><a href="estados/veracruz.html">Veracruz</a></li>
    </ul>
  </nav>

  <!-- Contenedor principal -->
  <div id="container">
    <!-- Panel izquierdo: encabezado + listado -->
    <div id="story">
      <img src="img/tittle.png" alt="Turismo Comunitario" loading="lazy">
      <section data-step="0">
        <h2>Estrategia de Turismo Comunitario en M√©xico</h2>
        <p class="justificado">El turismo comunitario en M√©xico es un modelo de desarrollo tur√≠stico que busca empoderar a las comunidades locales al involucrarlas directamente a la planificaci√≥n,
        operaci√≥n y beneficio de actividades tur√≠sticas en sus territorios.</p>
        <p class="justificado">Este enfoque permite a los visitantes experimental de manera aut√©ntica la cultura, trdicones, historia y entorno natura de las comunidades anfitrionas, promoviendo el respeto
        por los recursus naturales y el patrimonio cultura.</p>
        <img src="img/Turismo_9.jpg" alt="Turismo" loading="lazy">
      </section>

      <section data-step="2">
        <h2>Lo esencial del Turismo Comunitario <br> Qu√© es</br> </h2>
        <p class="justificado">Un turismo donde las actividades, productos y servicios que se ofrecen, son gestionados por las propias comunidades rurales e ind√≠genas.</p>
        <img src="img/Turismo_3.jpg" alt="Turismo" loading="lazy">
      </section>

      <section data-step="3">
        <h2>¬øPor qu√© elegirlo?</h2>
        <p class="justificado">¬°Es un turismo con impacto positivo!</p>
        <ul>
          <li>Ofrece experiencias aut√©nticas</li>
          <li>Apoya la econom√≠a local</li>
          <li>Preserva el medio ambiente</li>
        </ul>
        <p class="justificado">La ONU Turismo lo promueve como una herramienta para el desarrollo sostenible, la preservaci√≥n de la cultura y el entorno natural.</p>
        <img src="img/Turismo_4.jpg" alt="Turismo" loading="lazy">
      </section>

      <section data-step="4">
        <h2>Una forma de contribuir al desarrollo local <br> Qu√© es</br> </h2>
        <p class="justificado">Es elegir el Turismo Comunitario. Esta es solo una introducci√≥n de lo que debes saber sobre √©l. üå±.</p>
        <img src="img/Turismo_5.jpg" alt="Turismo" loading="lazy">
      </section>

      <section data-step="5">
        <h2>Actividades que puedes realizar de Turismo Comunitario </h2>
        <p class="justificado">Todas las actividades son ofrecidas por las propias comunidades locales quienes comparten sus conocimientos, tradiciones y formas de vida fortaleciendo su identidad y cultura.</p>
        <ul>
          <li>Talleres artesanales: Alfarer√≠a, bordado, tejido, etc.</li>
          <li>Talleres Gastron√≥micos: Aprender a preparar platillos locales con ingredientes de la regi√≥n</li>
          <li>Rutas de naturaleza y aventura guiadas por las comunidades locales como: Senderismo, monta√±ismo y ca√±onismo.</li>
          <img src="img/Turismo_10.jpg" alt="Turismo" loading="lazy">
        </ul>
      </section>

      <section data-step="10">
        <h2>Explora los estados</h2>
        <p class="justificado">Haz clic en un estado en el mapa o en el listado para conocerlo m√°s a fondo:</p>
        <ul>
          <li><a href="estados/baja_california_sur.html">Baja California Sur</a></li>
          <li><a href="estados/hidalgo.html">Hidalgo</a></li>
          <li><a href="estados/michoacan.html">Michoac√°n</a></li>
          <li><a href="estados/morelos.html">Morelos</a></li>
          <li><a href="estados/nayarit.html">Nayarit</a></li>
          <li><a href="estados/oaxaca.html">Oaxaca</a></li>
          <li><a href="estados/puebla.html">Puebla</a></li>
          <li><a href="estados/tlaxcala.html">Tlaxcala</a></li>
          <li><a href="estados/veracruz.html">Veracruz</a></li>
        </ul>
      </section>
      <!-- A√±ade tantas secciones como necesites -->
    </div>

    <!-- Panel derecho: mapa -->
    <div id="map"></div>
  </div>

  <!-- Scripts -->
  <!-- Quitamos Leaflet JS aqu√≠ para evitar conflicto: la portada ahora usa Mapbox GL -->
  <script src="js/scrollama.min.js"></script>

  <!-- Inicializaci√≥n Mapbox para la portada -->
  <script>
    // Token (puedes usar el tuyo)
    mapboxgl.accessToken = 'pk.eyJ1IjoieW1pbGFuZXMiLCJhIjoiY21ka2hma2UzMHVteDJscXkwZTh0anF4MSJ9.q4g1xy38WkjzzsskgLkfgw';

    // Mapa con estilo sat√©lite + etiquetas
    const map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/satellite-streets-v12',
      center: [-102.55, 23.63],
      zoom: 4.2,
      projection: 'globe'
    });
    map.addControl(new mapboxgl.NavigationControl(), 'top-right');

    // Helper para bounds de un GeoJSON
    function geojsonBounds(gj){
      const b = new mapboxgl.LngLatBounds();
      const walk = (coords) => {
        if (typeof coords[0] === 'number') b.extend(coords);
        else coords.forEach(walk);
      };
      if (gj.type === 'FeatureCollection') gj.features.forEach(f => walk(f.geometry.coordinates));
      else if (gj.type === 'Feature') walk(gj.geometry.coordinates);
      else walk(gj.coordinates);
      return b;
    }

    // Mapea nombre ‚Üí slug
    const slugMap = {
      'Aguascalientes':'aguascalientes',
      'Baja California':'baja_california',
      'Baja California Sur':'baja_california_sur',
      'Campeche':'campeche',
      'Chiapas':'chiapas',
      'Chihuahua':'chihuahua',
      'Ciudad de M√©xico':'ciudad_de_mexico',
      'Coahuila de Zaragoza':'coahuila',
      'Colima':'colima',
      'Durango':'durango',
      'Guanajuato':'guanajuato',
      'Guerrero':'guerrero',
      'Hidalgo':'hidalgo',
      'Jalisco':'jalisco',
      'M√©xico':'estado_de_mexico',
      'Michoac√°n de Ocampo':'michoacan',
      'Morelos':'morelos',
      'Nayarit':'nayarit',
      'Nuevo Le√≥n':'nuevo_leon',
      'Oaxaca':'oaxaca',
      'Puebla':'puebla',
      'Quer√©taro':'queretaro',
      'Quintana Roo':'quintana_roo',
      'San Luis Potos√≠':'san_luis_potosi',
      'Sinaloa':'sinaloa',
      'Sonora':'sonora',
      'Tabasco':'tabasco',
      'Tamaulipas':'tamaulipas',
      'Tlaxcala':'tlaxcala',
      'Veracruz de Ignacio de la Llave':'veracruz',
      'Yucat√°n':'yucatan',
      'Zacatecas':'zacatecas'
    };

    function slugify(s){
      return s.toLowerCase()
              .normalize('NFD').replace(/[\u0300-\u036f]/g,'')
              .replace(/\s+/g,'_');
    }

    // Carga Estados_1.geojson, pinta y activa clic
    const estadosURL = 'data/Estados_1.geojson';
    fetch(estadosURL)
      .then(r => r.json())
      .then(geo => {
        // Fuente
        map.addSource('mx-estados', { type:'geojson', data: geo });

        // Relleno y borde (verde)
        map.addLayer({
          id:'mx-fill',
          type:'fill',
          source:'mx-estados',
          paint:{
            'fill-color':'#2E8B57',
            'fill-opacity':0.18
          }
        });
        map.addLayer({
          id:'mx-line',
          type:'line',
          source:'mx-estados',
          paint:{
            'line-color':'#2E8B57',
            'line-width': 1.5
          }
        });

        // Fit a toda la rep√∫blica
        const b = geojsonBounds(geo);
        if (b && b.isEmpty && !b.isEmpty()) {
          // (Mapbox v3 LngLatBounds no tiene isEmpty fiable; hacemos try-catch)
          map.fitBounds(b, { padding: 40, duration: 800 });
        } else {
          map.fitBounds(b, { padding: 40, duration: 800 });
        }

        // Cursor y clic
        map.on('mouseenter','mx-fill', () => map.getCanvas().style.cursor = 'pointer');
        map.on('mouseleave','mx-fill', () => map.getCanvas().style.cursor = '');

        map.on('click','mx-fill', (e) => {
          const f = e.features && e.features[0];
          if (!f) return;
          const props = f.properties || {};
          const name = props.Estado || props.ESTADO || '';
          const slug = slugMap[name] || slugify(name);
          if (slug) {
            window.location.href = `estados/${slug}.html`;
          }
        });
      });

    // Toggle del men√∫ m√≥vil
    document.getElementById('nav-toggle')
      .addEventListener('click', () => {
        document.getElementById('nav-menu').classList.toggle('open');
      });
  </script>
</body>
</html>
